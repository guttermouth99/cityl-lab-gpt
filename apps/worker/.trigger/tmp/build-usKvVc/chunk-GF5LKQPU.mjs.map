{
  "version": 3,
  "sources": ["../../../src/jobs/classification/classify-organization.ts"],
  "sourcesContent": ["import { getOrganizationById, updateOrganization } from \"@baito/db/queries\";\nimport { classifyOrganization as classifyOrgLLM } from \"@baito/llm\";\nimport { task } from \"@trigger.dev/sdk\";\n\nexport const classifyOrganizationTask = task({\n  id: \"classify-organization\",\n  retry: {\n    maxAttempts: 3,\n  },\n  run: async (payload: { organizationId: string }) => {\n    const { organizationId } = payload;\n\n    const org = await getOrganizationById(organizationId);\n    if (!org) {\n      throw new Error(`Organization ${organizationId} not found`);\n    }\n\n    console.log(`Classifying organization: ${org.name}`);\n\n    // Use LLM to classify the organization\n    const result = await classifyOrgLLM({\n      name: org.name,\n      url: org.url || undefined,\n    });\n\n    console.log(\"Classification result:\", result);\n\n    // Update the organization with classification\n    if (result.confidence > 0.7) {\n      await updateOrganization(organizationId, {\n        isImpact: result.isImpact,\n      });\n    }\n\n    return {\n      organizationId,\n      name: org.name,\n      isImpact: result.isImpact,\n      confidence: result.confidence,\n      reason: result.reason,\n    };\n  },\n});\n"],
  "mappings": ";;;;;;;;;;;;;;;;AAAA;AAIO,IAAM,2BAA2B,KAAK;AAAA,EAC3C,IAAI;AAAA,EACJ,OAAO;AAAA,IACL,aAAa;AAAA,EACf;AAAA,EACA,KAAK,8BAAO,YAAwC;AAClD,UAAM,EAAE,eAAe,IAAI;AAE3B,UAAM,MAAM,MAAM,oBAAoB,cAAc;AACpD,QAAI,CAAC,KAAK;AACR,YAAM,IAAI,MAAM,gBAAgB,cAAc,YAAY;AAAA,IAC5D;AAEA,YAAQ,IAAI,6BAA6B,IAAI,IAAI,EAAE;AAGnD,UAAM,SAAS,MAAM,qBAAe;AAAA,MAClC,MAAM,IAAI;AAAA,MACV,KAAK,IAAI,OAAO;AAAA,IAClB,CAAC;AAED,YAAQ,IAAI,0BAA0B,MAAM;AAG5C,QAAI,OAAO,aAAa,KAAK;AAC3B,YAAM,mBAAmB,gBAAgB;AAAA,QACvC,UAAU,OAAO;AAAA,MACnB,CAAC;AAAA,IACH;AAEA,WAAO;AAAA,MACL;AAAA,MACA,MAAM,IAAI;AAAA,MACV,UAAU,OAAO;AAAA,MACjB,YAAY,OAAO;AAAA,MACnB,QAAQ,OAAO;AAAA,IACjB;AAAA,EACF,GAhCK;AAiCP,CAAC;",
  "names": []
}
