{
  "version": 3,
  "sources": ["../../../src/jobs/classification/classify-job.ts"],
  "sourcesContent": ["import { db } from \"@baito/db\";\nimport { getJobById } from \"@baito/db/queries\";\nimport { jobs } from \"@baito/db/schema\";\nimport { classifyJob as classifyJobLLM } from \"@baito/llm\";\nimport { task } from \"@trigger.dev/sdk\";\nimport { eq } from \"drizzle-orm\";\n\nexport const classifyJobTask = task({\n  id: \"classify-job\",\n  retry: {\n    maxAttempts: 3,\n  },\n  run: async (payload: { jobId: string }) => {\n    const { jobId } = payload;\n\n    const job = await getJobById(jobId);\n    if (!job) {\n      throw new Error(`Job ${jobId} not found`);\n    }\n\n    console.log(`Classifying job: ${job.title}`);\n\n    // Use LLM to classify the job\n    const result = await classifyJobLLM({\n      title: job.title,\n      description: job.description,\n      organizationName: job.organization?.name,\n    });\n\n    console.log(\"Classification result:\", result);\n\n    // Update the job with classification\n    await db\n      .update(jobs)\n      .set({\n        jobType: result.jobType as any,\n        jobBranch: result.jobBranch as any,\n        remoteType: result.remoteType as any,\n        experienceLevel: result.experienceLevel as any,\n        updatedAt: new Date(),\n      })\n      .where(eq(jobs.id, jobId));\n\n    return {\n      jobId,\n      title: job.title,\n      classification: result,\n    };\n  },\n});\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAOO,IAAM,kBAAkB,KAAK;AAAA,EAClC,IAAI;AAAA,EACJ,OAAO;AAAA,IACL,aAAa;AAAA,EACf;AAAA,EACA,KAAK,8BAAO,YAA+B;AACzC,UAAM,EAAE,MAAM,IAAI;AAElB,UAAM,MAAM,MAAM,WAAW,KAAK;AAClC,QAAI,CAAC,KAAK;AACR,YAAM,IAAI,MAAM,OAAO,KAAK,YAAY;AAAA,IAC1C;AAEA,YAAQ,IAAI,oBAAoB,IAAI,KAAK,EAAE;AAG3C,UAAM,SAAS,MAAM,YAAe;AAAA,MAClC,OAAO,IAAI;AAAA,MACX,aAAa,IAAI;AAAA,MACjB,kBAAkB,IAAI,cAAc;AAAA,IACtC,CAAC;AAED,YAAQ,IAAI,0BAA0B,MAAM;AAG5C,UAAM,GACH,OAAO,IAAI,EACX,IAAI;AAAA,MACH,SAAS,OAAO;AAAA,MAChB,WAAW,OAAO;AAAA,MAClB,YAAY,OAAO;AAAA,MACnB,iBAAiB,OAAO;AAAA,MACxB,WAAW,oBAAI,KAAK;AAAA,IACtB,CAAC,EACA,MAAM,GAAG,KAAK,IAAI,KAAK,CAAC;AAE3B,WAAO;AAAA,MACL;AAAA,MACA,OAAO,IAAI;AAAA,MACX,gBAAgB;AAAA,IAClB;AAAA,EACF,GApCK;AAqCP,CAAC;",
  "names": []
}
